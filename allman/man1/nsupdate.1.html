<link rel='stylesheet' href='../style.css'>
<script src='../script.js'></script>
<h1>NAME</h1>
<p>nsupdate - dynamic DNS update utility</p>
<h1>SYNOPSIS</h1>
<p><strong>nsupdate</strong> [<strong>-d</strong>] [<strong>-D</strong>]
[<strong>-i</strong>] [<strong>-L</strong> level] [
[<strong>-g</strong>] | [<strong>-o</strong>] | [<strong>-l</strong>] |
[<strong>-y</strong> [hmac:]keyname:secret] | [<strong>-k</strong>
keyfile] ] [<strong>-t</strong> timeout] [<strong>-u</strong>
udptimeout] [<strong>-r</strong> udpretries] [<strong>-v</strong>]
[<strong>-T</strong>] [<strong>-P</strong>] [<strong>-V</strong>] [
[<strong>-4</strong>] | [<strong>-6</strong>] ] [filename]</p>
<h1>DESCRIPTION</h1>
<p><strong>nsupdate</strong> is used to submit Dynamic DNS Update
requests, as defined in <em>RFC 2136</em>, to a name server. This allows
resource records to be added or removed from a zone without manually
editing the zone file. A single update request can contain requests to
add or remove more than one resource record.</p>
<p>Zones that are under dynamic control via <strong>nsupdate</strong> or
a DHCP server should not be edited by hand. Manual edits could conflict
with dynamic updates and cause data to be lost.</p>
<p>The resource records that are dynamically added or removed with
<strong>nsupdate</strong> must be in the same zone. Requests are sent to
the zone's primary server, which is identified by the MNAME field of the
zone's SOA record.</p>
<p>Transaction signatures can be used to authenticate the Dynamic DNS
updates. These use the TSIG resource record type described in <em>RFC
2845</em>, the SIG(0) record described in <em>RFC 2535</em> and <em>RFC
2931</em>, or GSS-TSIG as described in <em>RFC 3645</em>.</p>
<p>TSIG relies on a shared secret that should only be known to
<strong>nsupdate</strong> and the name server. For instance, suitable
<strong>key</strong> and <strong>server</strong> statements are added to
<strong>/etc/bind/named.conf</strong> so that the name server can
associate the appropriate secret key and algorithm with the IP address
of the client application that is using TSIG authentication.
<em>ddns-confgen</em> can generate suitable configuration fragments.
<strong>nsupdate</strong> uses the <em>-y</em> or <em>-k</em> options to
provide the TSIG shared secret; these options are mutually
exclusive.</p>
<p>SIG(0) uses public key cryptography. To use a SIG(0) key, the public
key must be stored in a KEY record in a zone served by the name
server.</p>
<p>GSS-TSIG uses Kerberos credentials. Standard GSS-TSIG mode is
switched on with the <em>-g</em> flag. A non-standards-compliant variant
of GSS-TSIG used by Windows 2000 can be switched on with the <em>-o</em>
flag.</p>
<h1>OPTIONS</h1>
<blockquote>
<dl>
<dt><strong>-4</strong></dt>
<dd>
<p>This option sets use of IPv4 only.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-6</strong></dt>
<dd>
<p>This option sets use of IPv6 only.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-C</strong></dt>
<dd>
<p>Overrides the default <em>resolv.conf</em> file. This is only
intended for testing.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-d</strong></dt>
<dd>
<p>This option sets debug mode, which provides tracing information about
the update requests that are made and the replies received from the name
server.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-D</strong></dt>
<dd>
<p>This option sets extra debug mode.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-g</strong></dt>
<dd>
<p>This option enables standard GSS-TSIG mode.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-i</strong></dt>
<dd>
<p>This option forces interactive mode, even when standard input is not
a terminal.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-k keyfile</strong></dt>
<dd>
<p>This option indicates the file containing the TSIG authentication
key. Keyfiles may be in two formats: a single file containing a
<em>named.conf</em>-format <strong>key</strong> statement, which may be
generated automatically by <em>ddns-confgen</em>; or a pair of files
whose names are of the format
<strong>K{name}.+157.+{random}.key</strong> and
<strong>K{name}.+157.+{random}.private</strong>, which can be generated
by <em>dnssec-keygen</em>. The <em>-k</em> option can also be used to
specify a SIG(0) key used to authenticate Dynamic DNS update requests.
In this case, the key specified is not an HMAC-MD5 key.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-l</strong></dt>
<dd>
<p>This option sets local-host only mode, which sets the server address
to localhost (disabling the <strong>server</strong> so that the server
address cannot be overridden). Connections to the local server use a
TSIG key found in <strong>/run/session.key</strong>, which is
automatically generated by <em>named</em> if any local
<strong>primary</strong> zone has set <strong>update-policy</strong> to
<strong>local</strong>. The location of this key file can be overridden
with the <em>-k</em> option.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-L level</strong></dt>
<dd>
<p>This option sets the logging debug level. If zero, logging is
disabled.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-o</strong></dt>
<dd>
<p>This option enables a non-standards-compliant variant of GSS-TSIG
used by Windows 2000.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-p port</strong></dt>
<dd>
<p>This option sets the port to use for connections to a name server.
The default is 53.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-P</strong></dt>
<dd>
<p>This option prints the list of private BIND-specific resource record
types whose format is understood by <strong>nsupdate</strong>. See also
the <em>-T</em> option.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-r udpretries</strong></dt>
<dd>
<p>This option sets the number of UDP retries. The default is 3. If
zero, only one update request is made.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-t timeout</strong></dt>
<dd>
<p>This option sets the maximum time an update request can take before
it is aborted. The default is 300 seconds. If zero, the timeout is
disabled for TCP mode. For UDP mode, the option <em>-u</em> takes
precedence over this option, unless the option <em>-u</em> is set to
zero, in which case the interval is computed from the <em>-t</em>
timeout interval and the number of UDP retries. For UDP mode, the
timeout can not be disabled, and will be rounded up to 1 second in case
if both <em>-t</em> and <em>-u</em> are set to zero.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-T</strong></dt>
<dd>
<p>This option prints the list of IANA standard resource record types
whose format is understood by <strong>nsupdate</strong>.
<strong>nsupdate</strong> exits after the lists are printed. The
<em>-T</em> option can be combined with the <em>-P</em> option.</p>
<p>Other types can be entered using <strong>TYPEXXXXX</strong> where
<strong>XXXXX</strong> is the decimal value of the type with no leading
zeros. The rdata, if present, is parsed using the UNKNOWN rdata format,
(&lt;backslash&gt; &lt;hash&gt; &lt;space&gt; &lt;length&gt;
&lt;space&gt; &lt;hexstring&gt;).</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-u udptimeout</strong></dt>
<dd>
<p>This option sets the UDP retry interval. The default is 3 seconds. If
zero, the interval is computed from the timeout interval and number of
UDP retries.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-v</strong></dt>
<dd>
<p>This option specifies that TCP should be used even for small update
requests. By default, <strong>nsupdate</strong> uses UDP to send update
requests to the name server unless they are too large to fit in a UDP
request, in which case TCP is used. TCP may be preferable when a batch
of update requests is made.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-V</strong></dt>
<dd>
<p>This option prints the version number and exits.</p>
</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt><strong>-y [hmac:]keyname:secret</strong></dt>
<dd>
<p>This option sets the literal TSIG authentication key.
<strong>keyname</strong> is the name of the key, and
<strong>secret</strong> is the base64 encoded shared secret.
<strong>hmac</strong> is the name of the key algorithm; valid choices
are <strong>hmac-md5</strong>, <strong>hmac-sha1</strong>,
<strong>hmac-sha224</strong>, <strong>hmac-sha256</strong>,
<strong>hmac-sha384</strong>, or <strong>hmac-sha512</strong>. If
<strong>hmac</strong> is not specified, the default is
<strong>hmac-md5</strong>, or if MD5 was disabled,
<strong>hmac-sha256</strong>.</p>
<p>NOTE: Use of the <em>-y</em> option is discouraged because the shared
secret is supplied as a command-line argument in clear text. This may be
visible in the output from ps1 or in a history file maintained by the
user's shell.</p>
</dd>
</dl>
</blockquote>
<h1>INPUT FORMAT</h1>
<p><strong>nsupdate</strong> reads input from <strong>filename</strong>
or standard input. Each command is supplied on exactly one line of
input. Some commands are for administrative purposes; others are either
update instructions or prerequisite checks on the contents of the zone.
These checks set conditions that some name or set of resource records
(RRset) either exists or is absent from the zone. These conditions must
be met if the entire update request is to succeed. Updates are rejected
if the tests for the prerequisite conditions fail.</p>
<p>Every update request consists of zero or more prerequisites and zero
or more updates. This allows a suitably authenticated update request to
proceed if some specified resource records are either present or missing
from the zone. A blank input line (or the <strong>send</strong> command)
causes the accumulated commands to be sent as one Dynamic DNS update
request to the name server.</p>
<p>The command formats and their meanings are as follows:</p>
<blockquote>
<dl>
<dt><strong><strong>server</strong> servername port</strong></dt>
<dd>
<p>This command sends all dynamic update requests to the name server
<strong>servername</strong>. When no server statement is provided,
<strong>nsupdate</strong> sends updates to the primary server of the
correct zone. The MNAME field of that zone's SOA record identify the
primary server for that zone. <strong>port</strong> is the port number
on <strong>servername</strong> where the dynamic update requests are
sent. If no port number is specified, the default DNS port number of 53
is used.</p>
<p><strong>NOTE:</strong></p>
<blockquote>
<p>This command has no effect when GSS-TSIG is in use.</p>
</blockquote>
</dd>
</dl>
<dl>
<dt><strong><strong>local</strong> address port</strong></dt>
<dd>
<p>This command sends all dynamic update requests using the local
<strong>address</strong>. When no local statement is provided,
<strong>nsupdate</strong> sends updates using an address and port chosen
by the system. <strong>port</strong> can also be used to force requests
to come from a specific port. If no port number is specified, the system
assigns one.</p>
</dd>
<dt><strong><strong>zone</strong> zonename</strong></dt>
<dd>
<p>This command specifies that all updates are to be made to the zone
<strong>zonename</strong>. If no <strong>zone</strong> statement is
provided, <strong>nsupdate</strong> attempts to determine the correct
zone to update based on the rest of the input.</p>
</dd>
<dt><strong><strong>class</strong> classname</strong></dt>
<dd>
<p>This command specifies the default class. If no
<strong>class</strong> is specified, the default class is
<strong>IN</strong>.</p>
</dd>
<dt><strong><strong>ttl</strong> seconds</strong></dt>
<dd>
<p>This command specifies the default time-to-live, in seconds, for
records to be added. The value <strong>none</strong> clears the default
TTL.</p>
</dd>
<dt><strong><strong>key</strong> hmac:keyname secret</strong></dt>
<dd>
<p>This command specifies that all updates are to be TSIG-signed using
the <strong>keyname</strong>-<strong>secret</strong> pair. If
<strong>hmac</strong> is specified, it sets the signing algorithm in
use. The default is <strong>hmac-md5</strong>; if MD5 was disabled, the
default is <strong>hmac-sha256</strong>. The <strong>key</strong>
command overrides any key specified on the command line via <em>-y</em>
or <em>-k</em>.</p>
</dd>
<dt><strong><strong>gsstsig</strong></strong></dt>
<dd>
<p>This command uses GSS-TSIG to sign the updates. This is equivalent to
specifying <em>-g</em> on the command line.</p>
</dd>
<dt><strong><strong>oldgsstsig</strong></strong></dt>
<dd>
<p>This command uses the Windows 2000 version of GSS-TSIG to sign the
updates. This is equivalent to specifying <em>-o</em> on the command
line.</p>
</dd>
<dt><strong><strong>realm</strong> [realm_name]</strong></dt>
<dd>
<p>When using GSS-TSIG, this command specifies the use of
<strong>realm_name</strong> rather than the default realm in
<strong>krb5.conf</strong>. If no realm is specified, the saved realm is
cleared.</p>
</dd>
<dt><strong><strong>check-names</strong> [boolean]</strong></dt>
<dd>
<p>This command turns on or off check-names processing on records to be
added. Check-names has no effect on prerequisites or records to be
deleted. By default check-names processing is on. If check-names
processing fails, the record is not added to the UPDATE message.</p>
</dd>
<dt><strong><strong>prereq</strong> nxdomain domain-name</strong></dt>
<dd>
<p>This command requires that no resource record of any type exist with
the name <strong>domain-name</strong>.</p>
</dd>
<dt><strong><strong>prereq</strong> yxdomain domain-name</strong></dt>
<dd>
<p>This command requires that <strong>domain-name</strong> exist (as at
least one resource record, of any type).</p>
</dd>
<dt><strong><strong>prereq</strong> nxrrset domain-name class
type</strong></dt>
<dd>
<p>This command requires that no resource record exist of the specified
<strong>type</strong>, <strong>class</strong>, and
<strong>domain-name</strong>. If <strong>class</strong> is omitted, IN
(Internet) is assumed.</p>
</dd>
<dt><strong><strong>prereq</strong> yxrrset domain-name class
type</strong></dt>
<dd>
<p>This command requires that a resource record of the specified
<strong>type</strong>, <strong>class</strong> and
<strong>domain-name</strong> exist. If <strong>class</strong> is
omitted, IN (internet) is assumed.</p>
</dd>
<dt><strong><strong>prereq</strong> yxrrset domain-name class type
data</strong></dt>
<dd>
<p>With this command, the <strong>data</strong> from each set of
prerequisites of this form sharing a common <strong>type</strong>,
<strong>class</strong>, and <strong>domain-name</strong> are combined to
form a set of RRs. This set of RRs must exactly match the set of RRs
existing in the zone at the given <strong>type</strong>,
<strong>class</strong>, and <strong>domain-name</strong>. The
<strong>data</strong> are written in the standard text representation of
the resource record's RDATA.</p>
</dd>
<dt><strong><strong>update</strong> delete domain-name ttl class type
data</strong></dt>
<dd>
<p>This command deletes any resource records named
<strong>domain-name</strong>. If <strong>type</strong> and
<strong>data</strong> are provided, only matching resource records are
removed. The Internet class is assumed if <strong>class</strong> is not
supplied. The <strong>ttl</strong> is ignored, and is only allowed for
compatibility.</p>
</dd>
<dt><strong><strong>update</strong> add domain-name ttl class type
data</strong></dt>
<dd>
<p>This command adds a new resource record with the specified
<strong>ttl</strong>, <strong>class</strong>, and
<strong>data</strong>.</p>
</dd>
<dt><strong><strong>show</strong></strong></dt>
<dd>
<p>This command displays the current message, containing all of the
prerequisites and updates specified since the last send.</p>
</dd>
<dt><strong><strong>send</strong></strong></dt>
<dd>
<p>This command sends the current message. This is equivalent to
entering a blank line.</p>
</dd>
<dt><strong><strong>answer</strong></strong></dt>
<dd>
<p>This command displays the answer.</p>
</dd>
<dt><strong><strong>debug</strong></strong></dt>
<dd>
<p>This command turns on debugging.</p>
</dd>
<dt><strong><strong>version</strong></strong></dt>
<dd>
<p>This command prints the version number.</p>
</dd>
<dt><strong><strong>help</strong></strong></dt>
<dd>
<p>This command prints a list of commands.</p>
</dd>
</dl>
</blockquote>
<p>Lines beginning with a semicolon (;) are comments and are
ignored.</p>
<h1>EXAMPLES</h1>
<p>The examples below show how <strong>nsupdate</strong> can be used to
insert and delete resource records from the <strong>example.com</strong>
zone. Notice that the input in each example contains a trailing blank
line, so that a group of commands is sent as one dynamic update request
to the primary name server for <strong>example.com</strong>.</p>
<blockquote>
<blockquote>
<pre><code># nsupdate
&gt; update delete oldhost.example.com A
&gt; update add newhost.example.com 86400 A 172.16.1.1
&gt; send</code></pre>
</blockquote>
</blockquote>
<p>Any A records for <strong>oldhost.example.com</strong> are deleted,
and an A record for <strong>newhost.example.com</strong> with IP address
172.16.1.1 is added. The newly added record has a TTL of 1 day (86400
seconds).</p>
<blockquote>
<blockquote>
<pre><code># nsupdate
&gt; prereq nxdomain nickname.example.com
&gt; update add nickname.example.com 86400 CNAME somehost.example.com
&gt; send</code></pre>
</blockquote>
</blockquote>
<p>The prerequisite condition tells the name server to verify that there
are no resource records of any type for
<strong>nickname.example.com</strong>. If there are, the update request
fails. If this name does not exist, a CNAME for it is added. This
ensures that when the CNAME is added, it cannot conflict with the
long-standing rule in <em>RFC 1034</em> that a name must not exist as
any other record type if it exists as a CNAME. (The rule has been
updated for DNSSEC in <em>RFC 2535</em> to allow CNAMEs to have RRSIG,
DNSKEY, and NSEC records.)</p>
<h1>FILES</h1>
<blockquote>
<dl>
<dt><strong><strong>/etc/resolv.conf</strong></strong></dt>
<dd>
<p>Used to identify the default name server</p>
</dd>
<dt><strong><strong>/run/session.key</strong></strong></dt>
<dd>
<p>Sets the default TSIG key for use in local-only mode</p>
</dd>
<dt><strong><strong>K{name}.+157.+{random}.key</strong></strong></dt>
<dd>
<p>Base-64 encoding of the HMAC-MD5 key created by
<em>dnssec-keygen</em>.</p>
</dd>
<dt><strong><strong>K{name}.+157.+{random}.private</strong></strong></dt>
<dd>
<p>Base-64 encoding of the HMAC-MD5 key created by
<em>dnssec-keygen</em>.</p>
</dd>
</dl>
</blockquote>
<h1>SEE ALSO</h1>
<p><em>RFC 2136</em>, <em>RFC 3007</em>, <em>RFC 2104</em>, <em>RFC
2845</em>, <em>RFC 1034</em>, <em>RFC 2535</em>, <em>RFC 2931</em>,
<em>named(8)</em>, <em>dnssec-keygen(8)</em>,
<em>tsig-keygen(8)</em>.</p>
<h1>BUGS</h1>
<p>The TSIG key is redundantly stored in two separate files. This is a
consequence of <strong>nsupdate</strong> using the DST library for its
cryptographic operations, and may change in future releases.</p>
<h1>AUTHOR</h1>
<p>Internet Systems Consortium</p>
<h1>COPYRIGHT</h1>
<p>2023, Internet Systems Consortium</p>
